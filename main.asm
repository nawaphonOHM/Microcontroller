;Nawaphon Isarathanachaikul 02/21/2018

.INCLUDE "m328pdef.inc"

.CSEG
	.ORG 0x0

		SET_PINs:
		LDI	R16, 0xFF	;Loads 11111111 into R16 for prepare DigitalPort Pin0-7 configure.
		LDI	R17, 0x0	;Loads 00000000 into R17 for prepare DigitalPort Pin8-13 configure and Analog PinA0-A5.
		OUT	DDRD, R16	;DDRD is DigitalPort Pin0-7.
		OUT	DDRB, R17	;DDRB is DigitalPort Pin8-13.
		OUT 	DDRC, R17	;DDRC is AnalogPort A0-A5.

		MAIN:
		IN		R16, PINB
		CALL	SHIFTSIGNEDBITFORCHECK
		BRPL	MORETHANZERO_1
		CPI		R16, 0x0
		BREQ	MORETHANZERO_1
		CALL	MAKESIGNEDTO2NDCOMPLEMENT
		MORETHANZERO_1:
		MOV		R25, R16
		IN		R16, PINC
		CALL	SHIFTSIGNEDBITFORCHECK
		BRPL	MORETHANZERO_2
		CPI		R16, 0x0
		BREQ	MORETHANZERO_2
		CALL	MAKESIGNEDTO2NDCOMPLEMENT
		MORETHANZERO_2:
		MOV		R24, R16
		ADD		R25, R24
		LDI		R16, 0x0
		BRPL	ITSPOSITIVE
		CALL	MAKEPOSITIVE
		ITSPOSITIVE:
		CPI		R25, 0xA
		BRPL	ITSMORETHANTEN
		LDI		R24, 0x0
		RJMP	SHOWTIME
		ITSMORETHANTEN:
		SUBI	R25, 0xA
		LDI		R24, 0x30
		SHOWTIME:
		ADD		R16, R25
		ADD		R16, R24
		OUT		PORTD, R16
		RJMP	MAIN

		MAKEPOSITIVE:
		LDI		R16, 0xC0
		NEG		R25
		RET

		SHIFTSIGNEDBITFORCHECK:
		MOV		R17, R16
		LSL		R17
		LSL		R17
		LSL		R17
		LSL		R17
		ANDI	R16, 0X7
		ANDI	R17, 0x80
		RET

		MAKESIGNEDTO2NDCOMPLEMENT:
		NEG		R16
		RET
